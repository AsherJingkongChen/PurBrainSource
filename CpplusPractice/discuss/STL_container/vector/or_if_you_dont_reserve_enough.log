==57359== Memcheck, a memory error detector
==57359== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==57359== Using Valgrind-3.19.0.GIT-lbmacos and LibVEX; rerun with -h for copyright info
==57359== Command: ./test
==57359== 
<L     1-> | <DECL> audio_track::ctor0  ()
u ----  main  ---- u
<L     2-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L     3-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L     4-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=1
<L     5-> | <DLOC> byte_buffer::destor ()
<L     6-> | <INFO> audio_track::get_num_buffers () | SIZ   1 . CAP  20
n ----  update  ---- n
<L     7-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L     8-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L     9-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=2
<L    10-> | <DLOC> byte_buffer::destor ()
<L    11-> | <INFO> audio_track::get_num_buffers () | SIZ   2 . CAP  20
n ----  update  ---- n
<L    12-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    13-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    14-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=3
<L    15-> | <DLOC> byte_buffer::destor ()
<L    16-> | <INFO> audio_track::get_num_buffers () | SIZ   3 . CAP  20
n ----  update  ---- n
<L    17-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    18-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    19-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=4
<L    20-> | <DLOC> byte_buffer::destor ()
<L    21-> | <INFO> audio_track::get_num_buffers () | SIZ   4 . CAP  20
n ----  update  ---- n
<L    22-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    23-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    24-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=5
<L    25-> | <DLOC> byte_buffer::destor ()
<L    26-> | <INFO> audio_track::get_num_buffers () | SIZ   5 . CAP  20
n ----  update  ---- n
<L    27-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    28-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    29-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=6
<L    30-> | <DLOC> byte_buffer::destor ()
<L    31-> | <INFO> audio_track::get_num_buffers () | SIZ   6 . CAP  20
n ----  update  ---- n
<L    32-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    33-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    34-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=7
<L    35-> | <DLOC> byte_buffer::destor ()
<L    36-> | <INFO> audio_track::get_num_buffers () | SIZ   7 . CAP  20
n ----  update  ---- n
<L    37-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    38-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    39-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=8
<L    40-> | <DLOC> byte_buffer::destor ()
<L    41-> | <INFO> audio_track::get_num_buffers () | SIZ   8 . CAP  20
n ----  update  ---- n
<L    42-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    43-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    44-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=9
<L    45-> | <DLOC> byte_buffer::destor ()
<L    46-> | <INFO> audio_track::get_num_buffers () | SIZ   9 . CAP  20
n ----  update  ---- n
<L    47-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    48-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    49-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=10
<L    50-> | <DLOC> byte_buffer::destor ()
<L    51-> | <INFO> audio_track::get_num_buffers () | SIZ  10 . CAP  20
n ----  update  ---- n
<L    52-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    53-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    54-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=11
<L    55-> | <DLOC> byte_buffer::destor ()
<L    56-> | <INFO> audio_track::get_num_buffers () | SIZ  11 . CAP  20
n ----  update  ---- n
<L    57-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    58-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    59-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=12
<L    60-> | <DLOC> byte_buffer::destor ()
<L    61-> | <INFO> audio_track::get_num_buffers () | SIZ  12 . CAP  20
n ----  update  ---- n
<L    62-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    63-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    64-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=13
<L    65-> | <DLOC> byte_buffer::destor ()
<L    66-> | <INFO> audio_track::get_num_buffers () | SIZ  13 . CAP  20
n ----  update  ---- n
<L    67-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    68-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    69-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=14
<L    70-> | <DLOC> byte_buffer::destor ()
<L    71-> | <INFO> audio_track::get_num_buffers () | SIZ  14 . CAP  20
n ----  update  ---- n
<L    72-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    73-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    74-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=15
<L    75-> | <DLOC> byte_buffer::destor ()
<L    76-> | <INFO> audio_track::get_num_buffers () | SIZ  15 . CAP  20
n ----  update  ---- n
<L    77-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    78-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    79-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=16
<L    80-> | <DLOC> byte_buffer::destor ()
<L    81-> | <INFO> audio_track::get_num_buffers () | SIZ  16 . CAP  20
n ----  update  ---- n
<L    82-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    83-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    84-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=17
<L    85-> | <DLOC> byte_buffer::destor ()
<L    86-> | <INFO> audio_track::get_num_buffers () | SIZ  17 . CAP  20
n ----  update  ---- n
<L    87-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    88-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    89-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=18
<L    90-> | <DLOC> byte_buffer::destor ()
<L    91-> | <INFO> audio_track::get_num_buffers () | SIZ  18 . CAP  20
n ----  update  ---- n
<L    92-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    93-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    94-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=19
<L    95-> | <DLOC> byte_buffer::destor ()
<L    96-> | <INFO> audio_track::get_num_buffers () | SIZ  19 . CAP  20
n ----  update  ---- n
<L    97-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L    98-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L    99-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=20
<L   100-> | <DLOC> byte_buffer::destor ()
<L   101-> | <INFO> audio_track::get_num_buffers () | SIZ  20 . CAP  20
n ----  update  ---- n
<L   102-> | <ALOC> byte_buffer::ctorA (size_t _num_frames)
<L   103-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   104-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   105-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   106-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   107-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   108-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   109-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   110-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   111-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   112-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   113-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   114-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   115-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   116-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   117-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   118-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   119-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   120-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   121-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   122-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   123-> | <MOVE> byte_buffer::mvctor (byte_buffer&& _src)
<L   124-> | <DLOC> byte_buffer::destor ()
<L   125-> | <DLOC> byte_buffer::destor ()
<L   126-> | <DLOC> byte_buffer::destor ()
<L   127-> | <DLOC> byte_buffer::destor ()
<L   128-> | <DLOC> byte_buffer::destor ()
<L   129-> | <DLOC> byte_buffer::destor ()
<L   130-> | <DLOC> byte_buffer::destor ()
<L   131-> | <DLOC> byte_buffer::destor ()
<L   132-> | <DLOC> byte_buffer::destor ()
<L   133-> | <DLOC> byte_buffer::destor ()
<L   134-> | <DLOC> byte_buffer::destor ()
<L   135-> | <DLOC> byte_buffer::destor ()
<L   136-> | <DLOC> byte_buffer::destor ()
<L   137-> | <DLOC> byte_buffer::destor ()
<L   138-> | <DLOC> byte_buffer::destor ()
<L   139-> | <DLOC> byte_buffer::destor ()
<L   140-> | <DLOC> byte_buffer::destor ()
<L   141-> | <DLOC> byte_buffer::destor ()
<L   142-> | <DLOC> byte_buffer::destor ()
<L   143-> | <DLOC> byte_buffer::destor ()
<L   144-> | <PUSH> audio_track::append (audio_buffer&& _rhs) | num_buffers=21
<L   145-> | <DLOC> byte_buffer::destor ()
<L   146-> | <INFO> audio_track::get_num_buffers () | SIZ  21 . CAP  40
n ----  update  ---- n
n ----  return 0  ---- n
<L   147-> | <DLOC> audio_track::destor ()
<L   148-> | <DLOC> byte_buffer::destor ()
<L   149-> | <DLOC> byte_buffer::destor ()
<L   150-> | <DLOC> byte_buffer::destor ()
<L   151-> | <DLOC> byte_buffer::destor ()
<L   152-> | <DLOC> byte_buffer::destor ()
<L   153-> | <DLOC> byte_buffer::destor ()
<L   154-> | <DLOC> byte_buffer::destor ()
<L   155-> | <DLOC> byte_buffer::destor ()
<L   156-> | <DLOC> byte_buffer::destor ()
<L   157-> | <DLOC> byte_buffer::destor ()
<L   158-> | <DLOC> byte_buffer::destor ()
<L   159-> | <DLOC> byte_buffer::destor ()
<L   160-> | <DLOC> byte_buffer::destor ()
<L   161-> | <DLOC> byte_buffer::destor ()
<L   162-> | <DLOC> byte_buffer::destor ()
<L   163-> | <DLOC> byte_buffer::destor ()
<L   164-> | <DLOC> byte_buffer::destor ()
<L   165-> | <DLOC> byte_buffer::destor ()
<L   166-> | <DLOC> byte_buffer::destor ()
<L   167-> | <DLOC> byte_buffer::destor ()
<L   168-> | <DLOC> byte_buffer::destor ()
==57359== 
==57359== HEAP SUMMARY:
==57359==     in use at exit: 17,935 bytes in 160 blocks
==57359==   total heap usage: 197 allocs, 37 frees, 27,671 bytes allocated
==57359== 
==57359== LEAK SUMMARY:
==57359==    definitely lost: 0 bytes in 0 blocks
==57359==    indirectly lost: 0 bytes in 0 blocks
==57359==      possibly lost: 0 bytes in 0 blocks
==57359==    still reachable: 2,048 bytes in 1 blocks
==57359==         suppressed: 15,887 bytes in 159 blocks
==57359== Reachable blocks (those to which a pointer was found) are not shown.
==57359== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==57359== 
==57359== For lists of detected and suppressed errors, rerun with: -s
==57359== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 5 from 5)
#include "audio_track.h"
#include "lockfree_task_queue.h"

static constexpr inline size_t
BUFS_APPEND = 21;

int main()
{
    audio_track TK;
    mark_("main");

    TK.prealloc(BUFS_APPEND - 1);

    /* push new buffers */
    for (size_t I = BUFS_APPEND; I--;)
    {
        TK.append(audio_buffer(96));
        TK.get_num_buffers();
        _mark("update");
    }

    _mark("return 0");
    return 0;
}
